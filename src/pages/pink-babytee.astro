---
import Layout from "../layouts/Layout.astro";
import Navigation from "../components/Navigation.astro";
import Footer from '../components/Footer.astro';
import "../styles/product.scss";
import { variationIndex } from '../store/product';


import directus from "../../lib/directus";
import { readSingleton, readCollections } from "@directus/sdk";
// const global = await directus.request(readSingleton("global"));
const result = await directus.request(readCollections());
console.log(result)

const pathImage = 'website_image/';

const relatedProduct = [{
  name: 'Pyjama Cổ Tròn',
  price: '259.000',
  img: '7.png',
  link: '',
}, {
  name: 'Pyjama Cổ Tròn Nơ',
  price: '279.000',
  img: '10.png',
  link: ''
},
{
  name: 'Bộ Hai Dây Nhí',
  price: '279.000',
  img: '10.png',
  link: ''
}];

const listVariations = [
  {
    imgs: [
    '4.png',
    '2.png',
    '3.png',
    '5.png',
    '6.png'
    ],
    name: 'Gấu Bo',
    imgVariation: '7.png',
  },
  {
    imgs: [
    '6.png',
    '4.png',
    '2.png',
    '3.png',
    '5.png',
    ],
    name: 'Gấu Teddy',
    imgVariation: '7.png',
  },  {
    imgs: [
    '2.png',
    '4.png',
    '3.png',
    '5.png',
    '6.png'
    ],
    name: 'Gấu Panyton',
    imgVariation: '7.png',
  }
]
const content = {
  name: 'Baby Tee Hồng',
  price: '179.000',
  rawPrice: '320.000',
  discount: '12%',
  description: [
    '° Chất liệu: Vải thun gân cotton lạnh hàn 4 chiều mềm mại và thoáng mát, mang lại cảm giác dễ chịu khi mặc.',
    '° Phong cách đơn giản và trẻ trung, phù hợp cho mùa hè ˙ᵕ˙',
    '° Set gồm: 1 áo Baby Tee + 1 quần.',
    '° Màu sắc: Hồng nhạt.']
}

---

<Layout>
  <!-- Navigation -->
  <Navigation />

  <!-- Breadcrumbs -->
  <div class="bg-pink-50 py-3">
    <div class="container mx-auto px-4 sm:px-6">
      <div class="text-sm text-gray-600">
        <a href="/" class="hover:text-pink-300">Trang chủ</a>
        <span class="hover:text-pink-300">/</span>
        <span class="text-pink-300">Baby Tee Hồng</span>
      </div>
    </div>
  </div>

  <!-- Product Detail Section -->
  <section class="py-4 sm:py-4">
    <div class="container mx-auto px-4 sm:px-6">
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Product Gallery -->
        <div class="lg:w-1/3 product-gallery">
          <div class="bg-white rounded-lg overflow-hidden shadow-sm mb-4">
            <img
              id="main-image"
              src={pathImage + listVariations[`${variationIndex.get()}`].imgs[0]}
              alt="Baby Tee Hồng"
              class="w-100px h-auto cursor-zoom-in"
              onclick="zoomImage()"
            />
          </div>

          <div class="flex overflow-x-auto thumbnail-container space-x-2 pb-2">
            {listVariations[`${variationIndex.get()}`].imgs.map((image) => (
              <div
                class="thumbnail bg-white rounded-md overflow-hidden cursor-pointer"
                onclick=`changeMainImage("${pathImage + image}", this)`>
                  <img
                    src={pathImage + image}
                    alt="Baby Tee Hồng"
                    class="w-full h-full object-cover"
                  />
              </div>
            ))}
            
          </div>
        </div>

        <!-- Product Info -->
        <div class="lg:w-2/3">
          <h1
            class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2 heading-font"
          >
            {content.name}
          </h1>

          <div class="mb-6">
            <span class="text-2xl font-bold text-pink-300">{content.price}</span>
            <span class="ml-2 text-gray-500 line-through">{content.rawPrice}</span>
            <span
              class="ml-2 text-pink-300 bg-pink-100 px-2 py-1 rounded text-sm"
              >{content.discount} OFF</span
            >
          </div>
          <p class="text-gray-700 font-bold mb-2">
            ✿ Chi Tiết Sản Phẩm: 
          </p>

          <p class=" mb-4">
            {content.description.map((dataDescription) => (
              <p class="text-gray-500  ml-2">{dataDescription}</p>
            ))}
          </p>

          <div class="mb-8 mt-8">
            <h3 class="text-sm font-semibold text-gray-800 mb-2">SIZE: 42-52kg</h3>
            <a
              href="#"
              class="text-pink-300 text-sm mt-2 inline-block hover:underline"
              >View Size Chart</a
            >
          </div>

          <div class="flex flex-col sm:flex-row gap-3 mb-6 w-1/2">
            <button
              class="bg-pink-300 hover:bg-pink-400 text-white px-6 py-3 rounded-full font-medium transition duration-300 flex-1 text-center touch-target"
            >
              <i class="fas fa-shopping-cart mr-2"></i> Mua ngay
            </button>
          </div>

          <div class="border-t border-b border-gray-200 py-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-gray-700 text-sm"
                ><i class="fas fa-truck text-pink-300 mr-2"></i> Free Shipping</span
              >
            </div>
            <div class="flex items-center justify-between">
              <span class="text-gray-700 text-sm"
                ><i class="fas fa-undo text-pink-300 mr-2"></i>Đổi trả</span
              >
              <span class="text-gray-700 text-sm">30 ngày từ khi mua sản phẩm</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Product Details Tabs -->
  <section class="py-8 bg-white">
    <div class="container mx-auto px-4 sm:px-6">
      <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8">
          <button
            id="details-tab"
            class="tab-button active border-b-2 border-pink-300 text-pink-300 px-1 py-4 text-sm font-medium"
          >
            Video
          </button>
        </nav>
      </div>

      <div
        id="details-content"
        class="tab-content active py-6"
      >
        <ul class="list-disc pl-5 text-gray-700 space-y-2">
          <li>Super soft cotton blend fabric (95% cotton, 5% spandex)</li>
          <li>Relaxed fit for ultimate comfort</li>
          <li>Breathable material keeps you cool all night</li>
          <li>Elastic waistband with adjustable drawstring</li>
          <li>Machine washable - gets softer with every wash</li>
          <li>Set includes: top with button front and matching pants</li>
          <li>Delicate cloud pattern in soothing pastel colors</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Related Products -->
  <section class="py-12 bg-white">
    <div class="container mx-auto px-4 sm:px-6">
      <div class="flex justify-between items-center mb-8">
        <h2 class="text-2xl font-bold text-gray-800 heading-font">
          Sản phẩm bạn thích
        </h2>
        <a
          href="#"
          class="text-pink-300 hover:text-pink-400 font-medium"
          >Tất cả sản phẩm</a
        >
      </div>

      <div class={`grid grid-cols-5 md:grid-cols-5 gap-4 sm:gap-6`}>
        {relatedProduct.map((otherProduct) => (
          <div
            class="product-card bg-white rounded-lg overflow-hidden shadow-sm transition duration-300 hover:shadow-md"
          >
            <div class="relative pb-[125%] overflow-hidden">
              <img
                src={pathImage + otherProduct.img}
                alt={otherProduct.name}
                class="absolute top-0 left-0 w-full h-full object-cover"
              />
              <button
                class="absolute top-2 right-2 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm hover:bg-pink-100"
              >
                <i class="far fa-heart text-gray-600"></i>
              </button>
            </div>
            <div class="p-4">
              <h3 class="text-sm font-semibold text-gray-800 mb-1">
                {otherProduct.name}
              </h3>
              <p class="text-pink-300 font-medium">{otherProduct.price}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
  <hr class="my-12 h-0.5 border-t-0 bg-neutral-100 dark:bg-white/10" />
  <Footer />

  <script>
    import '../scripts/menu'
    import {changeMainImage, zoomImage, selectColor, selectSize} from  '../scripts/products'
    declare global {
        interface Window {
            changeMainImage: any;
            zoomImage: any;
            selectColor: any;
            selectSize: any;
        }
    }
    window.changeMainImage = changeMainImage
    window.zoomImage = zoomImage  
    window.selectColor = selectColor
    window.selectSize = selectSize
  </script>
</Layout>
